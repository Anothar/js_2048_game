!function(){function t(t,e,n,r,a,i,u){try{var s=t[i](u),c=s.value}catch(t){n(t);return}s.done?e(c):Promise.resolve(c).then(r,a)}function e(e){return function(){var n=this,r=arguments;return new Promise(function(a,i){var u=e.apply(n,r);function s(e){t(u,a,i,s,c,"next",e)}function c(e){t(u,a,i,s,c,"throw",e)}s(void 0)})}}function n(t,e){var n,r,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(u=0)),u;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,r=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){u=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){u.label=s[1];break}if(6===s[0]&&u.label<a[1]){u.label=a[1],a=s;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(s);break}a[2]&&u.ops.pop(),u.trys.pop();continue}s=e.call(t,u)}catch(t){s=[6,t],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}}function i(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||a(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}"function"==typeof SuppressedError&&SuppressedError;var u,s,c,o,l,f,m=function(t){var e=Math.floor(4*Math.random()),n=Math.floor(4*Math.random());return 0===t[e][n]?[e,n]:m(t)},h=new(function(){var t;function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,r),this.initialState=t,this.score=0,this.status="none"}return t=[{key:"gameAdderItem",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=this;return e(function(){var i,u;return n(this,function(s){switch(s.label){case 0:var c;if(c=e(function(){var t,e,i;return n(this,function(n){var u;return e=(t=function(t){if(Array.isArray(t))return t}(u=m(r.initialState))||function(t,e){var n,r,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i=[],u=!0,s=!1;try{for(a=a.call(t);!(u=(n=a.next()).done)&&(i.push(n.value),2!==i.length);u=!0);}catch(t){s=!0,r=t}finally{try{u||null==a.return||a.return()}finally{if(s)throw r}}return i}}(u,2)||a(u,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],i=t[1],r.initialState[e][i]=Math.floor(10*Math.random())+1<=1?4:2,[2]})}),i=function(){return c.apply(this,arguments)},u=r.initialState.reduce(function(t,e){return t+e.reduce(function(t,e){return t+(0===e?1:0)},0)},0),"start"!==t)return[3,3];return[4,i()];case 1:return s.sent(),[4,i()];case 2:return s.sent(),[3,5];case 3:if(!(u>=1))return[3,5];return[4,i()];case 4:s.sent(),s.label=5;case 5:return[2]}})})()}},{key:"moveLeft",value:function(){var t=this;return e(function(){var r,a,u;return n(this,function(s){switch(s.label){case 0:var c,o;return r=t.initialState,c=e(function(){return n(this,function(e){return t.initialState=t.initialState.map(function(e,n){for(var r=e.filter(function(t){return 0===t}),a=i(e.filter(function(t){return 0!==t})).concat(i(r)),u=0;u<3;u++)a[u]===a[u+1]&&0!==a[u]&&(a[u]=a[u]+a[u+1],t.score+=a[u],a[u+1]=0,u+=1);return a}),[2]})}),a=function(){return c.apply(this,arguments)},o=e(function(){return n(this,function(e){return t.initialState=t.initialState.map(function(t,e){var n=t.filter(function(t){return 0===t});return i(t.filter(function(t){return 0!==t})).concat(i(n))}),[2]})}),u=function(){return o.apply(this,arguments)},[4,a()];case 1:return s.sent(),[4,u()];case 2:if(s.sent(),r.toString()===t.initialState.toString())return[2];return[4,t.gameAdderItem()];case 3:return s.sent(),[2]}})})()}},{key:"moveRight",value:function(){var t=this;return e(function(){var r,a,u;return n(this,function(s){switch(s.label){case 0:var c,o;return r=t.initialState,c=e(function(){return n(this,function(e){return t.initialState=t.initialState.map(function(e,n){for(var r=e.filter(function(t){return 0===t}),a=e.filter(function(t){return 0!==t}),u=i(r).concat(i(a)),s=3;s>0;s--)u[s]===u[s-1]&&0!==u[s]&&(u[s]=u[s]+u[s-1],t.score+=u[s],u[s-1]=0,s-=1);return u}),[2]})}),a=function(){return c.apply(this,arguments)},o=e(function(){return n(this,function(e){return t.initialState=t.initialState.map(function(t,e){var n=t.filter(function(t){return 0===t}),r=t.filter(function(t){return 0!==t});return i(n).concat(i(r))}),[2]})}),u=function(){return o.apply(this,arguments)},[4,a()];case 1:return s.sent(),[4,u()];case 2:if(s.sent(),r.toString()===t.initialState.toString())return[2];return[4,t.gameAdderItem()];case 3:return s.sent(),[2]}})})()}},{key:"moveUp",value:function(){var t=this;return e(function(){var r,a,u;return n(this,function(s){switch(s.label){case 0:var c,o;return r=t.initialState,c=e(function(){var e;return n(this,function(n){return e=[t.initialState.map(function(t){return t[0]}),t.initialState.map(function(t){return t[1]}),t.initialState.map(function(t){return t[2]}),t.initialState.map(function(t){return t[3]})].map(function(e,n){for(var r=e.filter(function(t){return 0===t}),a=i(e.filter(function(t){return 0!==t})).concat(i(r)),u=0;u<3;u++)a[u]===a[u+1]&&0!==a[u]&&(a[u]=a[u]+a[u+1],t.score+=a[u],a[u+1]=0,u+=1);return a}),t.initialState=[e.map(function(t){return t[0]}),e.map(function(t){return t[1]}),e.map(function(t){return t[2]}),e.map(function(t){return t[3]})],[2]})}),a=function(){return c.apply(this,arguments)},o=e(function(){var e;return n(this,function(n){return e=[t.initialState.map(function(t){return t[0]}),t.initialState.map(function(t){return t[1]}),t.initialState.map(function(t){return t[2]}),t.initialState.map(function(t){return t[3]})].map(function(t,e){var n=t.filter(function(t){return 0===t});return i(t.filter(function(t){return 0!==t})).concat(i(n))}),t.initialState=[e.map(function(t){return t[0]}),e.map(function(t){return t[1]}),e.map(function(t){return t[2]}),e.map(function(t){return t[3]})],[2]})}),u=function(){return o.apply(this,arguments)},[4,a()];case 1:return s.sent(),[4,u()];case 2:if(s.sent(),r.toString()===t.initialState.toString())return[2];return[4,t.gameAdderItem()];case 3:return s.sent(),[2]}})})()}},{key:"moveDown",value:function(){var t=this;return e(function(){var r,a,u;return n(this,function(s){switch(s.label){case 0:var c,o;return r=t.initialState,c=e(function(){var e;return n(this,function(n){return e=[t.initialState.map(function(t){return t[0]}),t.initialState.map(function(t){return t[1]}),t.initialState.map(function(t){return t[2]}),t.initialState.map(function(t){return t[3]})].map(function(e,n){for(var r=e.filter(function(t){return 0===t}),a=e.filter(function(t){return 0!==t}),u=i(r).concat(i(a)),s=3;s>0;s--)u[s]===u[s-1]&&0!==u[s]&&(u[s]=u[s]+u[s-1],t.score+=u[s],u[s-1]=0,s-=1);return u}),t.initialState=[e.map(function(t){return t[0]}),e.map(function(t){return t[1]}),e.map(function(t){return t[2]}),e.map(function(t){return t[3]})],[2]})}),a=function(){return c.apply(this,arguments)},o=e(function(){var e;return n(this,function(n){return e=[t.initialState.map(function(t){return t[0]}),t.initialState.map(function(t){return t[1]}),t.initialState.map(function(t){return t[2]}),t.initialState.map(function(t){return t[3]})].map(function(t,e){var n=t.filter(function(t){return 0===t}),r=t.filter(function(t){return 0!==t});return i(n).concat(i(r))}),t.initialState=[e.map(function(t){return t[0]}),e.map(function(t){return t[1]}),e.map(function(t){return t[2]}),e.map(function(t){return t[3]})],[2]})}),u=function(){return o.apply(this,arguments)},[4,a()];case 1:return s.sent(),[4,u()];case 2:if(s.sent(),r.toString()===t.initialState.toString())return[2];return[4,t.gameAdderItem()];case 3:return s.sent(),[2]}})})()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.initialState}},{key:"setStatus",value:function(){if(this.initialState.some(function(t){return t.includes(2048)}))return"win"!==this.status&&(this.status="win"),this.status;var t=!1;return this.initialState.forEach(function(e,n){for(var r=e.filter(function(t){return 0===t}),a=i(e.filter(function(t){return 0!==t})).concat(i(r)),u=0;u<3;u++)a[u]===a[u+1]&&0!==a[u]&&(t=!0);for(var s=3;s>0;s--)a[s]===a[s-1]&&0!==a[s]&&(t=!0)}),[this.initialState.map(function(t){return t[0]}),this.initialState.map(function(t){return t[1]}),this.initialState.map(function(t){return t[2]}),this.initialState.map(function(t){return t[3]})].forEach(function(e,n){for(var r=e.filter(function(t){return 0===t}),a=i(e.filter(function(t){return 0!==t})).concat(i(r)),u=0;u<3;u++)a[u]===a[u+1]&&0!==a[u]&&(t=!0);for(var s=3;s>0;s--)a[s]===a[s-1]&&0!==a[s]&&(t=!0)}),this.initialState.forEach(function(e){e.includes(0)&&(t=!0)}),t||(this.status="lose"),this.status}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){var t=this;return e(function(){return n(this,function(e){switch(e.label){case 0:return[4,t.gameAdderItem("start")];case 1:return e.sent(),t.status="start",[2]}})})()}},{key:"restart",value:function(){var t=this;return e(function(){return n(this,function(e){return t.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],t.start(),t.score=0,t.status="start",[2]})})()}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(r.prototype,t),r}())([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),p=Array.from(document.querySelectorAll(".field-row")).map(function(t){return Array.from(t.querySelectorAll(".field-cell"))}),d=document.querySelector(".game-score"),v=document.querySelector(".message-lose"),g=document.querySelector(".message-win"),S=document.querySelector(".message-start"),y=(c=e(function(){var t,e;return n(this,function(n){switch(t=h.getState(),e=h.setStatus(),d.textContent=h.getScore(),p.map(function(e,n){return e.map(function(e,r){e.textContent=t[n][r]?t[n][r]:"",e.className=t[n][r]?"field-cell field-cell--".concat(t[n][r]):"field-cell"})}),e){case"none":"message message-lose hidden"!==v.className&&(v.className="message message-lose hidden"),"message message-win hidden"!==g.className&&(g.className="message message-win hidden"),"message message-start"!==S.className&&(S.className="message message-start");break;case"start":"message message-lose hidden"!==v.className&&(v.className="message message-lose hidden"),"message message-win hidden"!==g.className&&(g.className="message message-win hidden"),"message message-start hidden"!==S.className&&(S.className="message message-start hidden");break;case"lose":"message message-lose"!==v.className&&(v.className="message message-lose"),"message message-win hidden"!==g.className&&(g.className="message message-win hidden"),"message message-start hidden"!==S.className&&(S.className="message message-start hidden");break;case"win":"message message-lose hidden"!==v.className&&(v.className="message message-lose hidden"),"message message-win"!==g.className&&(g.className="message message-win"),"message message-start hidden"!==S.className&&(S.className="message message-start hidden")}return[2]})}),function(){return c.apply(this,arguments)}),b=document.querySelector(".button");b.addEventListener("click",e(function(){return n(this,function(t){switch(t.label){case 0:if(!b.classList.contains("start"))return[3,2];return b.classList.remove("start"),b.classList.add("restart"),b.textContent="Restart",[4,h.start()];case 1:return t.sent(),y(),[3,4];case 2:return[4,h.restart()];case 3:t.sent(),y(),t.label=4;case 4:return[2]}})}));var w=!0,N=(o=e(function(t){return n(this,function(e){switch(e.label){case 0:return w=!1,[4,h[t]()];case 1:return e.sent(),[4,y()];case 2:return e.sent(),w=!0,[2]}})}),function(t){return o.apply(this,arguments)});document.documentElement.addEventListener("keydown",(l=e(function(t){return n(this,function(e){switch(e.label){case 0:if("start"!==h.getStatus()||!w)return[2];switch(t.key){case"ArrowRight":return[3,1];case"ArrowLeft":return[3,3];case"ArrowUp":return[3,5];case"ArrowDown":return[3,7]}return[3,9];case 1:return[4,N("moveRight")];case 2:case 4:case 6:case 8:return e.sent(),[3,10];case 3:return[4,N("moveLeft")];case 5:return[4,N("moveUp")];case 7:return[4,N("moveDown")];case 9:return[3,10];case 10:return[2]}})}),function(t){return l.apply(this,arguments)}));var A=document.querySelector(".game-field");A.addEventListener("touchstart",function(t){u=t.touches[0].clientX,s=event.touches[0].clientY}),A.addEventListener("touchmove",(f=e(function(t){var e,r,a,i;return n(this,function(n){switch(n.label){case 0:if(t.preventDefault(),"start"!==h.getStatus()||!w)return[2];if(e=t.touches[0].clientX,r=t.touches[0].clientY,!(Math.abs(a=e-u)>Math.abs(i=r-s)))return[3,5];if(!(a>50))return[3,2];return[4,N("moveRight")];case 1:return n.sent(),w=!1,[3,4];case 2:if(!(a<-50))return[3,4];return[4,N("moveLeft")];case 3:n.sent(),w=!1,n.label=4;case 4:return[3,9];case 5:if(!(i>50))return[3,7];return[4,N("moveDown")];case 6:return n.sent(),w=!1,[3,9];case 7:if(!(i<-50))return[3,9];return[4,N("moveUp")];case 8:n.sent(),w=!1,n.label=9;case 9:return[2]}})}),function(t){return f.apply(this,arguments)})),A.addEventListener("touchend",function(){u=null,s=null,w=!0})}();
//# sourceMappingURL=index.f6a31f44.js.map
