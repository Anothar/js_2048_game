let t,e;const a=t=>{let e=Math.floor(4*Math.random()),s=Math.floor(4*Math.random());return 0===t[e][s]?[e,s]:a(t)},s=()=>Math.floor(10*Math.random())+1<=1?4:2,i=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.score=0,this.status="none"}async gameAdderItem(t=""){let e=async()=>{let[t,e]=a(this.initialState);this.initialState[t][e]=s()},i=this.initialState.reduce((t,e)=>t+e.reduce((t,e)=>t+(0===e?1:0),0),0);"start"===t?(await e(),await e()):i>=1&&await e()}async moveLeft(){let t=this.initialState,e=async()=>{this.initialState=this.initialState.map((t,e)=>{let a=t.filter(t=>0===t),s=[...t.filter(t=>0!==t),...a];for(let t=0;t<3;t++)s[t]===s[t+1]&&0!==s[t]&&(s[t]=s[t]+s[t+1],this.score+=s[t],s[t+1]=0,t+=1);return s})},a=async()=>{this.initialState=this.initialState.map((t,e)=>{let a=t.filter(t=>0===t);return[...t.filter(t=>0!==t),...a]})};await e(),await a(),t.toString()!==this.initialState.toString()&&await this.gameAdderItem()}async moveRight(){let t=this.initialState,e=async()=>{this.initialState=this.initialState.map((t,e)=>{let a=[...t.filter(t=>0===t),...t.filter(t=>0!==t)];for(let t=3;t>0;t--)a[t]===a[t-1]&&0!==a[t]&&(a[t]=a[t]+a[t-1],this.score+=a[t],a[t-1]=0,t-=1);return a})},a=async()=>{this.initialState=this.initialState.map((t,e)=>[...t.filter(t=>0===t),...t.filter(t=>0!==t)])};await e(),await a(),t.toString()!==this.initialState.toString()&&await this.gameAdderItem()}async moveUp(){let t=this.initialState,e=async()=>{let t=[this.initialState.map(t=>t[0]),this.initialState.map(t=>t[1]),this.initialState.map(t=>t[2]),this.initialState.map(t=>t[3])].map((t,e)=>{let a=t.filter(t=>0===t),s=[...t.filter(t=>0!==t),...a];for(let t=0;t<3;t++)s[t]===s[t+1]&&0!==s[t]&&(s[t]=s[t]+s[t+1],this.score+=s[t],s[t+1]=0,t+=1);return s});this.initialState=[t.map(t=>t[0]),t.map(t=>t[1]),t.map(t=>t[2]),t.map(t=>t[3])]},a=async()=>{let t=[this.initialState.map(t=>t[0]),this.initialState.map(t=>t[1]),this.initialState.map(t=>t[2]),this.initialState.map(t=>t[3])].map((t,e)=>{let a=t.filter(t=>0===t);return[...t.filter(t=>0!==t),...a]});this.initialState=[t.map(t=>t[0]),t.map(t=>t[1]),t.map(t=>t[2]),t.map(t=>t[3])]};await e(),await a(),t.toString()!==this.initialState.toString()&&await this.gameAdderItem()}async moveDown(){let t=this.initialState,e=async()=>{let t=[this.initialState.map(t=>t[0]),this.initialState.map(t=>t[1]),this.initialState.map(t=>t[2]),this.initialState.map(t=>t[3])].map((t,e)=>{let a=[...t.filter(t=>0===t),...t.filter(t=>0!==t)];for(let t=3;t>0;t--)a[t]===a[t-1]&&0!==a[t]&&(a[t]=a[t]+a[t-1],this.score+=a[t],a[t-1]=0,t-=1);return a});this.initialState=[t.map(t=>t[0]),t.map(t=>t[1]),t.map(t=>t[2]),t.map(t=>t[3])]},a=async()=>{let t=[this.initialState.map(t=>t[0]),this.initialState.map(t=>t[1]),this.initialState.map(t=>t[2]),this.initialState.map(t=>t[3])].map((t,e)=>[...t.filter(t=>0===t),...t.filter(t=>0!==t)]);this.initialState=[t.map(t=>t[0]),t.map(t=>t[1]),t.map(t=>t[2]),t.map(t=>t[3])]};await e(),await a(),t.toString()!==this.initialState.toString()&&await this.gameAdderItem()}getScore(){return this.score}getState(){return this.initialState}setStatus(){if(this.initialState.some(t=>t.includes(2048)))return"win"!==this.status&&(this.status="win"),this.status;let t=!1;return this.initialState.forEach((e,a)=>{let s=e.filter(t=>0===t),i=[...e.filter(t=>0!==t),...s];for(let e=0;e<3;e++)i[e]===i[e+1]&&0!==i[e]&&(t=!0);for(let e=3;e>0;e--)i[e]===i[e-1]&&0!==i[e]&&(t=!0)}),[this.initialState.map(t=>t[0]),this.initialState.map(t=>t[1]),this.initialState.map(t=>t[2]),this.initialState.map(t=>t[3])].forEach((e,a)=>{let s=e.filter(t=>0===t),i=[...e.filter(t=>0!==t),...s];for(let e=0;e<3;e++)i[e]===i[e+1]&&0!==i[e]&&(t=!0);for(let e=3;e>0;e--)i[e]===i[e-1]&&0!==i[e]&&(t=!0)}),this.initialState.forEach(e=>{e.includes(0)&&(t=!0)}),t||(this.status="lose"),this.status}getStatus(){return this.status}async start(){await this.gameAdderItem("start"),this.status="start"}async restart(){this.initialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.start(),this.score=0,this.status="start"}}([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),n=Array.from(document.querySelectorAll(".field-row")).map(t=>Array.from(t.querySelectorAll(".field-cell"))),l=document.querySelector(".game-score"),m=document.querySelector(".message-lose"),r=document.querySelector(".message-win"),c=document.querySelector(".message-start"),o=async()=>{let t=i.getState(),e=i.setStatus();switch(l.textContent=i.getScore(),n.map((e,a)=>e.map((e,s)=>{e.textContent=t[a][s]?t[a][s]:"",e.className=t[a][s]?`field-cell field-cell--${t[a][s]}`:"field-cell"})),e){case"none":"message message-lose hidden"!==m.className&&(m.className="message message-lose hidden"),"message message-win hidden"!==r.className&&(r.className="message message-win hidden"),"message message-start"!==c.className&&(c.className="message message-start");break;case"start":"message message-lose hidden"!==m.className&&(m.className="message message-lose hidden"),"message message-win hidden"!==r.className&&(r.className="message message-win hidden"),"message message-start hidden"!==c.className&&(c.className="message message-start hidden");break;case"lose":"message message-lose"!==m.className&&(m.className="message message-lose"),"message message-win hidden"!==r.className&&(r.className="message message-win hidden"),"message message-start hidden"!==c.className&&(c.className="message message-start hidden");break;case"win":"message message-lose hidden"!==m.className&&(m.className="message message-lose hidden"),"message message-win"!==r.className&&(r.className="message message-win"),"message message-start hidden"!==c.className&&(c.className="message message-start hidden")}},h=document.querySelector(".button");h.addEventListener("click",async()=>{h.classList.contains("start")?(h.classList.remove("start"),h.classList.add("restart"),h.textContent="Restart",await i.start()):await i.restart(),o()});let d=!0;const g=async t=>{d=!1,await i[t](),await o(),d=!0};document.documentElement.addEventListener("keydown",async function(t){if("start"===i.getStatus()&&d)switch(t.key){case"ArrowRight":await g("moveRight");break;case"ArrowLeft":await g("moveLeft");break;case"ArrowUp":await g("moveUp");break;case"ArrowDown":await g("moveDown")}});const S=document.querySelector(".game-field");S.addEventListener("touchstart",function(a){t=a.touches[0].clientX,e=event.touches[0].clientY}),S.addEventListener("touchmove",async function(a){if(a.preventDefault(),"start"!==i.getStatus()||!d)return;let s=a.touches[0].clientX,n=a.touches[0].clientY,l=s-t,m=n-e;Math.abs(l)>Math.abs(m)?l>50?(await g("moveRight"),d=!1):l<-50&&(await g("moveLeft"),d=!1):m>50?(await g("moveDown"),d=!1):m<-50&&(await g("moveUp"),d=!1)}),S.addEventListener("touchend",function(){t=null,e=null,d=!0});
//# sourceMappingURL=index.c28535d3.js.map
